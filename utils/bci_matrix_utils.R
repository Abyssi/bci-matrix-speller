alphabet <- c("A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z", "1", "2", "3", "4", "5", "6", "7", "8", "9", "_")

find_char <- function(row, column) {
  #cat("row ", row, "column ", column, "\n")
  m = matrix(alphabet, nrow=6, ncol=6, byrow = TRUE)
  #print(m[row, column-6])
  return(m[row, column-6])
}

translate_to_char <- function(c, y) { 
  indices <- c[which(y %in% 1)]
  #print(indices)
  return(find_char(if(!is.null(indices) & length(indices) > 0) if (indices[1] < 7) indices[1] else 1 else 1, if(!is.null(indices) & length(indices) > 0) if (indices[length(indices)] > 6) indices[length(indices)] else 7 else 7))
}

best_char <- function(c, y) { 
  results <- rep(0, times = length(alphabet))
  names(results) <- alphabet
  for (i in 0:9) {
    found_char <- translate_to_char(c[i*12+1:12], y[i*12+1:12])
    results[found_char] <- results[found_char]+1
  }
  return(alphabet[which.max(results)])
}

translate_to_word <- function(c, y) {
  result <- list()
  for (i in 0:(round(length(c)/120) - 1)) {
    found_char <- best_char(c[i*120+1:120], y[i*120+1:120])
    result <- append(result, found_char)
  }
  return(paste(result, collapse=''))
}

find_best_pair <- function(y) {
  result <- rep(c(-1), times = 12)
  result[order(y[1:6])[1]] <- 1
  result[6+order(y[7:12])[1]] <- 1
  return(result)
}

find_best_pairs <- function(y) {
  result <- c()
  for (i in 0:floor(length(test_result$output)/12)) {
    result <- append(result, find_best_pair(y[i*12+1:12]))
  }
  return(result)
}


#c_test <- rep(c(1, 2, 6, 4, 3, 5, 7, 8, 12, 10, 9, 11), times = 10*5)
#y_test <- rep(c(-1, -1, -1, -1, -1, 1, -1, -1, -1, 1, -1, -1), times = 10*5)

c_test <- c(1, 2, 6, 4, 3, 5, 7, 8, 12, 10, 9, 11, 4, 6, 1, 3, 5, 2, 10, 12, 7, 9, 11, 8, 3, 1, 4, 5, 2, 6, 9, 7, 10, 11, 8, 12, 5, 4, 3, 2, 6, 1, 11, 10, 9, 8, 12, 7, 2, 3, 5, 6, 1, 4, 8, 9, 11, 12, 7, 10, 6, 5, 2, 1, 4, 3, 12, 11, 8, 7, 10, 9, 1, 2, 6, 4, 3, 5, 7, 8, 12, 10, 9, 11, 4, 6, 1, 3, 5, 2, 10, 12, 7, 9, 11, 8, 1, 2, 6, 4, 3, 5, 7, 8, 12, 10, 9, 11, 4, 6, 1, 3, 5, 2, 10, 12, 7, 9, 11, 8, 1, 2, 6, 4, 3, 5, 7, 8, 12, 10, 9, 11, 4, 6, 1, 3, 5, 2, 10, 12, 7, 9, 11, 8, 3, 1, 4, 5, 2, 6, 9, 7, 10, 11, 8, 12, 5, 4, 3, 2, 6, 1, 11, 10, 9, 8, 12, 7, 2, 3, 5, 6, 1, 4, 8, 9, 11, 12, 7, 10, 6, 5, 2, 1, 4, 3, 12, 11, 8, 7, 10, 9, 1, 2, 6, 4, 3, 5, 7, 8, 12, 10, 9, 11, 4, 6, 1, 3, 5, 2, 10, 12, 7, 9, 11, 8, 1, 2, 6, 4, 3, 5, 7, 8, 12, 10, 9, 11, 4, 6, 1, 3, 5, 2, 10, 12, 7, 9, 11, 8, 1, 2, 6, 4, 3, 5, 7, 8, 12, 10, 9, 11, 4, 6, 1, 3, 5, 2, 10, 12, 7, 9, 11, 8, 3, 1, 4, 5, 2, 6, 9, 7, 10, 11, 8, 12, 5, 4, 3, 2, 6, 1, 11, 10, 9, 8, 12, 7, 2, 3, 5, 6, 1, 4, 8, 9, 11, 12, 7, 10, 6, 5, 2, 1, 4, 3, 12, 11, 8, 7, 10, 9, 1, 2, 6, 4, 3, 5, 7, 8, 12, 10, 9, 11, 4, 6, 1, 3, 5, 2, 10, 12, 7, 9, 11, 8, 1, 2, 6, 4, 3, 5, 7, 8, 12, 10, 9, 11, 4, 6, 1, 3, 5, 2, 10, 12, 7, 9, 11, 8, 1, 2, 6, 4, 3, 5, 7, 8, 12, 10, 9, 11, 4, 6, 1, 3, 5, 2, 10, 12, 7, 9, 11, 8, 3, 1, 4, 5, 2, 6, 9, 7, 10, 11, 8, 12, 5, 4, 3, 2, 6, 1, 11, 10, 9, 8, 12, 7, 2, 3, 5, 6, 1, 4, 8, 9, 11, 12, 7, 10, 6, 5, 2, 1, 4, 3, 12, 11, 8, 7, 10, 9, 1, 2, 6, 4, 3, 5, 7, 8, 12, 10, 9, 11, 4, 6, 1, 3, 5, 2, 10, 12, 7, 9, 11, 8, 1, 2, 6, 4, 3, 5, 7, 8, 12, 10, 9, 11, 4, 6, 1, 3, 5, 2, 10, 12, 7, 9, 11, 8, 1, 2, 6, 4, 3, 5, 7, 8, 12, 10, 9, 11, 4, 6, 1, 3, 5, 2, 10, 12, 7, 9, 11, 8, 3, 1, 4, 5, 2, 6, 9, 7, 10, 11, 8, 12, 5, 4, 3, 2, 6, 1, 11, 10, 9, 8, 12, 7, 2, 3, 5, 6, 1, 4, 8, 9, 11, 12, 7, 10, 6, 5, 2, 1, 4, 3, 12, 11, 8, 7, 10, 9, 1, 2, 6, 4, 3, 5, 7, 8, 12, 10, 9, 11, 4, 6, 1, 3, 5, 2, 10, 12, 7, 9, 11, 8, 1, 2, 6, 4, 3, 5, 7, 8, 12, 10, 9, 11, 4, 6, 1, 3, 5, 2, 10, 12, 7, 9, 11, 8)
y_test <- c(-1, -1, -1, -1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, 1, -1, -1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, -1, -1, 1, -1, 1, -1, -1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, 1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, 1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, -1, -1, 1, -1, 1, -1, -1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, 1, -1, -1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, -1, -1, 1, 1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, -1, -1, 1, 1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, 1, -1, -1, 1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 1, -1, -1, 1, -1, -1, -1, -1, -1, -1, -1, 1, -1, -1, 1, -1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, -1, 1, 1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, -1, 1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, 1, -1, -1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, -1, -1, 1, -1, 1, -1, -1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, 1, -1, -1)

res <- translate_to_word(c_test, y_test)
res 
#translate_to_char(c_test, y_test)
#paste(c(find_char(4, 11), find_char(5, 11)), collapse='')


